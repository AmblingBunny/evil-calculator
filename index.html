<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>evil-evil_calculator</title>
</head>

<body>
    <div id="atkspd_input">
        <div>Hunter Type</div>
        <div>
            <select id="hunter_type" onchange="evil_calc()">
                <option value="4">Berserker</option>
                <option value="1">Ranger</option>
                <option value="1">Sorcerer</option>
                <option value="1" selected>Paladin</option>
            </select>
        </div>
        <div>Weapon ATKSPD</div>
        <div><input type="text" id="atkspd_weapon" value="2.4" onblur="evil_calc()"></div>
        <div>Expected ATKSPD</div>
        <div><input type="text" id="atkspd_expected" value="0.25" onblur="evil_calc()"></div>
        <div>Quicken Level</div>
        <div><input type="number" id="quicken_level" min="0" max="5" value="0" onchange="evil_calc()"></div>
        <div>Characteristic</div>
        <div>
            <select class="atkspd_bonus" onchange="evil_calc()">
                <option value="0" selected>None +0%</option>
                <option value="7">Heroic +7%</option>
                <option value="10">Swift +10%</option>
                <option value="-10">Thickheaded -10%</option>
            </select>
        </div>
        <div>Attribute</div>
        <div>
            <select class="atkspd_bonus" onchange="evil_calc()">
                <option value="0">Normal +0%</option>
                <option value="10">Rare +10%</option>
                <option value="20" selected>Legendary +20%</option>
                <option value="30">Ultimate +30%</option>
            </select>
        </div>
        <div>Equipment</div>
        <div><input type="text" class="atkspd_bonus" value="0" onblur="evil_calc()">%</div>
        <div>Secret Tech</div>
        <div><input type="text" class="atkspd_bonus" value="0" onblur="evil_calc()">%</div>
        <div>Guild</div>
        <div><input type="text" class="atkspd_bonus" value="0" onblur="evil_calc()">%</div>
        <div>Rune</div>
        <div><input type="text" class="atkspd_bonus" value="0" onblur="evil_calc()">%</div>
    </div>
    <div id="Result">
        <p>ATKSPD: 0</p><p>Need: 0%</p>
    </div>

<script>
    function evil_calc(){
        // Attack Speed
        const atkspd_div = document.getElementById("atkspd_input")
        const inputs = atkspd_div.querySelectorAll('.atkspd_bonus');
        let atkspd_bonus_all = 0;
        inputs.forEach(input => {
            atkspd_bonus_all += Number(input.value);
        })

        const result_div = document.getElementById("Result")
        const atkspd_weapon = Number(document.getElementById("atkspd_weapon").value);
        const atkspd_expected = Number(document.getElementById("atkspd_expected").value);
        const quicken_level = Number(document.getElementById("quicken_level").value);
        const basic_spd_ratio = Number(document.getElementById("hunter_type").value);
        let atkspd_pannel = Math.max(Math.round(atkspd_weapon*(1-atkspd_bonus_all/100)/(1 + quicken_level * 0.1)*100)/100, 0.25);
        let atkspd_need = Math.max(Math.ceil((1 - atkspd_expected * (basic_spd_ratio + quicken_level * 0.1) / atkspd_weapon)*100 - atkspd_bonus_all), 0);
        result_div.innerHTML = `<p>ATKSPD: ${atkspd_pannel}</p><p>Need: ${atkspd_need}%</p>`
    }
</script>


<script>
    evil_calc()
</script>

</body>

</html>